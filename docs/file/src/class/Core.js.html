<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/class/Core.js | lumi-web-core</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Lumi Wallet Core - Web Version"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="lumi-web-core"><meta property="twitter:description" content="Lumi Wallet Core - Web Version"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/lumiwallet/lumi-web-core"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Wrapper.js~Wrapper.html">Wrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/index.js~Wallet.html">Wallet</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class">class</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/Core.js~Core.html">Core</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/WalletWrapper.js~WalletWrapper.html">WalletWrapper</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-bch">class/BCH</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BCH/BitcoinCashSync.js~BitcoinCashSync.html">BitcoinCashSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BCH/BitcoinCashTx.js~BitcoinCashTx.html">BitcoinCashTx</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-bnb">class/BNB</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BNB/transaction.js~BinanceTx.html">BinanceTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-decodeAddress">decodeAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeAddress">encodeAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBnbAddressByPublicKey">getBnbAddressByPublicKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertObjectToSignBytes">convertObjectToSignBytes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeArrayBinary">encodeArrayBinary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeBinary">encodeBinary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeBinaryByteArray">encodeBinaryByteArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeBool">encodeBool</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeNumber">encodeNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeObjectBinary">encodeObjectBinary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeString">encodeString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-marshalBinary">marshalBinary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBnbCore">getBnbCore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertToBinance">convertToBinance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertToJager">convertToJager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateSignature">generateSignature</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AminoPrefix">AminoPrefix</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-btc">class/BTC</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BTC/BitcoinSync.js~BitcoinSync.html">BitcoinSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BTC/BitcoinTx.js~BitcoinTx.html">BitcoinTx</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-btcv">class/BTCV</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BTCV/BitcoinVaultSync.js~BitcoinVaultSync.html">BitcoinVaultSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/BTCV/BitcoinVaultTx.js~BitcoinVaultTx.html">BitcoinVaultTx</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-doge">class/DOGE</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/DOGE/DogecoinSync.js~DogecoinSync.html">DogecoinSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/DOGE/DogecoinTx.js~DogecoinTx.html">DogecoinTx</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#class-eth">class/ETH</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/ETH/EthereumSync.js~EthereumSync.html">EthereumSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/class/ETH/EthereumTx.js~EthereumTx.html">EthereumTx</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#helpers">helpers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/helpers/Request.js~Request.html">Request</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/helpers/handleErrors.js~CustomError.html">CustomError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-calcBtcTxSize">calcBtcTxSize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertToCashAddress">convertToCashAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-derive">derive</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateMnemonic">generateMnemonic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBtcAddress">getBtcAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBtcAddressByPublicKey">getBtcAddressByPublicKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBtcPrivateKeyByIndex">getBtcPrivateKeyByIndex</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getCashAddress">getCashAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getDogeAddress">getDogeAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEthAddress">getEthAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEthAddressByNode">getEthAddressByNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEthPrivateKey">getEthPrivateKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEthPublicKey">getEthPublicKey</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getXprv">getXprv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hdFromSeed">hdFromSeed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hdFromXprv">hdFromXprv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeRawBchTx">makeRawBchTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeRawBtcTx">makeRawBtcTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeRawBtcvTx">makeRawBtcvTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeRawDogeTx">makeRawDogeTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeRawEthTx">makeRawEthTx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mnemonicToEntropy">mnemonicToEntropy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mnemonicToSeed">mnemonicToSeed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-privateKeyToWIF">privateKeyToWIF</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-requestHandleErrors">requestHandleErrors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toFormatDecimal">toFormatDecimal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-networks">networks</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ab2hexstring">ab2hexstring</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeBinaryByteArray">encodeBinaryByteArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sha256">sha256</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sha256ripemd160">sha256ripemd160</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sha3">sha3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-UVarInt">UVarInt</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-VarInt">VarInt</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/class/Core.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import {validateMnemonic} from &apos;bip39&apos;
import {normalize, checkWords} from &apos;bip39-checker&apos;
import CustomError from &apos;@/helpers/handleErrors&apos;
import * as core from &apos;@/helpers/coreHelper&apos;
import {getBnbCore} from &apos;@/class/BNB/core&apos;
import {getBnbAddressByPublicKey} from &apos;@/class/BNB/address&apos;

/**
 * Class Wallet
 * @class
 */

export default class Core {
  /**
   * Create a core
   * @param {Object} data
   * @param {string} data.from - A type new wallet creating: new, mnemonic or xprv
   * @param {number} data.count - Number of words for the new mnemonic. Is used when parameter from is &apos;new&apos;
   * @param {string} data.mnemonic - The mnemonic phrase. It used when parameter from is &apos;mnemonic&apos;
   * @param {string} data.key - BIP32 Root Key. It used when parameter from is &apos;mnemonic&apos;
   */
  constructor (data = {}) {
    const {from, count, mnemonic, key} = data
    this.from = from
    this.count = count || 12
    this.mnemonic = mnemonic
    this.xprv = key
    this.seed = null
    this.hdkey = null
    this.coins = {}
  }

  /**
   * The main method that starts the generation of the core.
   * The type of generation depends on the parameter &apos;from&apos;
   */

  async generateWallet () {
    switch (this.from) {
      case &apos;new&apos;:
        this._generateNewMnemonic()
        break
      case &apos;mnemonic&apos;:
        this._importByMnemonic()
        break
      case &apos;xprv&apos;:
        this._importByKey()
        break
      default:
        this._generateNewMnemonic()
    }
  }

  /**
   * Generating a new mnemonic.
   * The number of words in a mnemonic depends on the parameter &apos;count&apos;
   * @private
   */

  _generateNewMnemonic () {
    const entropy = this._getEntropyLength(this.count)
    this.mnemonic = core.generateMnemonic(entropy)
    this.seed = core.mnemonicToSeed(this.mnemonic)
    this.hdkey = core.hdFromSeed(this.seed)
    this.xprv = core.getXprv(this.hdkey)
  }

  /**
   * Importing a wallet by mnemonic
   * @private
   */

  _importByMnemonic () {
    this.mnemonic = normalize(this.mnemonic)
    if (!this.checkMnemonic(this.mnemonic)) {
      throw new CustomError(&apos;err_core_mnemonic&apos;)
    }
    this.seed = core.mnemonicToSeed(this.mnemonic)
    this.hdkey = core.hdFromSeed(this.seed)
    this.xprv = core.getXprv(this.hdkey)
  }

  /**
   * Importing a wallet by key
   * @private
   */

  _importByKey () {
    if (!this.xprv || typeof this.xprv !== &apos;string&apos;) {
      throw new CustomError(&apos;err_core_xprv&apos;)
    }
    this.hdkey = core.hdFromXprv(this.xprv)
  }

  /**
   * Creating a core for each supported currency type
   *
   * @param {Array&lt;{coin: String, type: String}&gt;} coins
   * @param {string} coins[].coin - Short name of coin. Supported coins are BTC, ETH, BCH, BTCV and DOGE
   * @param {string|number} coins[].type - Coin type (additional).
   * For BTC supported types are p2pkh and p2wpkh. For ETH type is a account number (by default 0).
   * */

  async createCoinsCores (coins = []) {
    let core = {}

    for (let item of coins) {
      const {coin, type} = item
      if (!core.hasOwnProperty(coin)) {
        core[coin] = {}
      }

      switch (coin) {
        case &apos;BTC&apos;:
          core[coin][type] = await this._generateBTCcore(type)
          break
        case &apos;ETH&apos;:
          core[coin][type] = await this._generateETHcore(type)
          break
        case &apos;BCH&apos;:
          core[coin].p2pkh = await this._generateBCHcore()
          break
        case &apos;BTCV&apos;:
          core[coin].p2wpkh = await this._generateBTCVcore()
          break
        case &apos;DOGE&apos;:
          core[coin].p2pkh = await this._generateDOGEcore()
          break
        case &apos;BNB&apos;:
          core[coin].p2pkh = await this._generateBNBcore()
          break
      }
    }

    return core
  }

  /**
   * Creating a core for Bitcoin.
   * At the output, we get a external and internal node,
   * derivation path and the first addresses of the external and internal cores
   *
   * @param {string} type - Bitcoin type. There may be p2pkh or p2wpkh
   * @private
   */

  _generateBTCcore (type = &apos;p2pkh&apos;) {
    const bitcoin_paths = {
      p2pkh: `m/44&apos;/0&apos;/0&apos;`,
      p2wpkh: `m/84&apos;/0&apos;/0&apos;`
    }

    if (!(type in bitcoin_paths)) {
      throw new CustomError(&apos;err_core_btc_type&apos;)
    }

    const bitcoin_external_path = bitcoin_paths[type] + &apos;/0&apos;
    const bitcoin_internal_path = bitcoin_paths[type] + &apos;/1&apos;

    let item = {}
    item.externalNode = core.derive(this.hdkey, bitcoin_external_path)
    item.internalNode = core.derive(this.hdkey, bitcoin_internal_path)
    item.externalAddress = core.getBtcAddress(item.externalNode, 0, type)
    item.internalAddress = core.getBtcAddress(item.internalNode, 0, type)
    item.dp = {
      external: bitcoin_external_path,
      internal: bitcoin_internal_path
    }

    if (!this.coins.hasOwnProperty(&apos;BTC&apos;)) {
      this.coins.BTC = {}
    }

    this.coins.BTC[type] = item
    return item
  }

  /**
   * Creating a core for Ethereum.
   * At the output, we get a Ethereum node, derivation path,
   * a private and public key, and the Ethereum address
   *
   * @param {number} type - Ethereum account number. By default 0
   * @private
   */

  _generateETHcore (type = 0) {
    if (!Number.isInteger(type)) {
      throw new CustomError(&apos;err_core_eth_account&apos;)
    }

    const ethereum_path = `m/44&apos;/60&apos;/${ type }&apos;/0/0`
    let item = {}

    item.node = core.derive(this.hdkey, ethereum_path)
    item.privateKey = core.getEthPrivateKey(item.node)
    item.privateKeyHex = &apos;0x&apos; + item.privateKey.toString(&apos;hex&apos;)
    item.publicKey = core.getEthPublicKey(item.privateKey)
    item.externalAddress = core.getEthAddress(item.publicKey)
    item.dp = ethereum_path

    if (!this.coins.hasOwnProperty(&apos;ETH&apos;)) {
      this.coins.ETH = {}
    }

    this.coins.ETH[type] = item
    return item
  }

  /**
   * Creating a core for Bitcoin Cash.
   * At the output, we get a external and internal node,
   * derivation path and the first addresses of the external and internal cores
   * @private
   */

  _generateBCHcore () {
    const type = &apos;p2pkh&apos;
    const bitcoincash_external_path = `m/44&apos;/145&apos;/0&apos;/0`
    const bitcoincash_internal_path = `m/44&apos;/145&apos;/0&apos;/1`
    let item = {}
    item.externalNode = core.derive(this.hdkey, bitcoincash_external_path)
    item.internalNode = core.derive(this.hdkey, bitcoincash_internal_path)
    item.externalAddress = core.getBtcAddress(item.externalNode, 0)
    item.internalAddress = core.getBtcAddress(item.internalNode, 0)
    item.dp = {external: bitcoincash_external_path, internal: bitcoincash_internal_path}

    if (!this.coins.hasOwnProperty(&apos;BCH&apos;)) {
      this.coins.BCH = {}
    }

    this.coins.BCH[type] = item
    return item
  }

  /**
   * Creating a core for Bitcoin Vault.
   * At the output, we get a external and internal node,
   * derivation path and the first addresses of the external and internal cores
   * @private
   */

  async _generateBTCVcore () {
    const type = &apos;p2wpkh&apos;
    const network = &apos;btcv&apos;
    const bitcoinvault_external_path = `m/84&apos;/440&apos;/0&apos;/0`
    const bitcoinvault_internal_path = `m/84&apos;/440&apos;/0&apos;/1`

    let item = {}
    item.externalNode = core.derive(this.hdkey, bitcoinvault_external_path)
    item.internalNode = core.derive(this.hdkey, bitcoinvault_internal_path)
    item.externalAddress = core.getBtcAddress(item.externalNode, 0, &apos;p2wpkh&apos;, network)
    item.internalAddress = core.getBtcAddress(item.internalNode, 0, &apos;p2wpkh&apos;, network)
    item.dp = {external: bitcoinvault_external_path, internal: bitcoinvault_internal_path}

    if (!this.coins.hasOwnProperty(&apos;BTCV&apos;)) {
      this.coins.BTCV = {}
    }

    this.coins.BTCV[type] = item
    return item
  }

  /**
   * Creating a core for Dogecoin.
   * At the output, we get a external and internal node,
   * derivation path and the first addresses of the external and internal cores
   * @private
   */
  async _generateDOGEcore () {
    const type = &apos;p2pkh&apos;
    const dogecoin_external_path = `m/44&apos;/3&apos;/0&apos;/0`
    const dogecoin_internal_path = `m/44&apos;/3&apos;/0&apos;/1`

    let item = {}
    item.externalNode = core.derive(this.hdkey, dogecoin_external_path)
    item.internalNode = core.derive(this.hdkey, dogecoin_internal_path)
    item.externalAddress = core.getDogeAddress(item.externalNode, 0)
    item.internalAddress = core.getDogeAddress(item.internalNode, 0)
    item.dp = {external: dogecoin_external_path, internal: dogecoin_internal_path}

    if (!this.coins.hasOwnProperty(&apos;DOGE&apos;)) {
      this.coins.DOGE = {}
    }

    this.coins.DOGE[type] = item
    return item
  }

  /**
   * Creating a core for Binance Coin.
   * At the output, we get a external and internal node,
   * derivation path and the external address
   * @private
   */
  async _generateBNBcore () {
    const type = &apos;p2pkh&apos;

    if (!Object.prototype.hasOwnProperty.call(this.coins, &apos;BNB&apos;)) {
      this.coins.BNB = {}
    }
    this.coins.BNB[type] = getBnbCore(this.hdkey)
    return this.coins.BNB[type]
  }

  /**
   * The method returns information about child nodes by the derivation path and range
   * @param {Object} data
   * @param {number} data.from - Top of the derivation range
   * @param {number} data.to - End of the derivation range
   * @param {string} data.path - Derivation path
   * @param {Array} data.coins - Array of coins for generating addresses. Includes the coin param (e.g. BTC) and the type param (e.g. p2pkh or account number) parameters
   * @returns {{node: {privateExtendedKey: *, publicExtendedKey: *}, list: []}} Returns object with node information
   * @returns {Object} node - Contains privateExtendedKey and publicExtendedKey
   * @returns {Array} list - Array of child nodes. Every child node contains the following parameters:
   * derivation path, publick key, private key in WIF format and addresses if a list of coins was sent
   */

  getChildNodes (data = {}) {
    const types = [&apos;p2pkh&apos;, &apos;p2wpkh&apos;]
    let {from, to, path, coins} = data

    from = +from
    to = +to
    coins = coins || []

    if (!Number.isInteger(from) || !Number.isInteger(to) || from &gt; to) {
      throw new CustomError(&apos;err_core_derivation_range&apos;)
    }

    try {
      const node = core.derive(this.hdkey, path)

      let info = {
        node: {
          privateExtendedKey: node.privateExtendedKey,
          publicExtendedKey: node.publicExtendedKey
        },
        list: []
      }

      for (let i = from; i &lt;= to; i++) {
        const child = {}
        const deriveChild = node.deriveChild(i)
        child.path = `${ path }/${ i }`
        child.privateKey = core.privateKeyToWIF(deriveChild.privateKey)
        child.publicKey = deriveChild.publicKey.toString(&apos;hex&apos;)
        for (let item of coins) {
          let {coin, type} = item

          switch (coin) {
            case &apos;BTC&apos;:
              if (!types.includes(type)) continue
              child[`${ type }Address`] = core.getBtcAddress(node, i, type, &apos;btc&apos;)
              break
            case &apos;BCH&apos;:
              child.bchAddress = core.getCashAddress(node, i)
              break
            case &apos;BTCV&apos;:
              child.btcvAddress = core.getBtcAddress(node, i, &apos;p2wpkh&apos;, &apos;btcv&apos;)
              break
            case &apos;ETH&apos;:
              child.ethAddress = core.getEthAddressByNode(deriveChild)
              break
            case &apos;DOGE&apos;:
              child.dogeAddress = core.getDogeAddress(node, i)
              break
            case &apos;BNB&apos;:
              child.bnbAddress = getBnbAddressByPublicKey(node._publicKey.toString(&apos;hex&apos;))
              break
          }
        }
        info.list.push(child)
      }

      return info
    }
    catch (e) {
      throw new CustomError(&apos;err_core_derivation&apos;)
    }
  }

  /**
   * Checking the mnemonic for validity
   * @param mnemonic
   * @returns {boolean}
   */

  checkMnemonic (mnemonic) {
    let words = mnemonic.split(&apos; &apos;)
    let withTypo = []

    words.forEach((word, index) =&gt; {
      if (!checkWords(word, &apos;english&apos;)) {
        withTypo.push(index)
      }
    })

    if (withTypo.length) {
      throw new CustomError(&apos;err_core_mnemonic&apos;)
    }

    return validateMnemonic(mnemonic)
  }

  /**
   * Getting the entropy size by the number of words in a mnemonic
   * @param words
   * @returns {number} Bits of entropy
   * @private
   */

  _getEntropyLength (words) {
    let bitsOfEntropy = {
      12: 128,
      15: 160,
      18: 192,
      21: 224,
      24: 256
    }

    if (!bitsOfEntropy.hasOwnProperty(+words)) {
      throw new CustomError(&apos;err_core_entropy&apos;)
    }

    return bitsOfEntropy[words]
  }

  get DATA () {
    return {
      mnemonic: this.mnemonic,
      xprv: this.xprv,
      from: this.from,
      hdkey: this.hdkey,
      seed: this.seed,
      seedInHex: this.seed ? this.seed.toString(&apos;hex&apos;) : null
    }
  }

  get COINS () {
    return {
      ...this.coins
    }
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
